# Создание климатической карты {#map-design-climates}



[Скачать данные и файл отчета](http://autolab.geogr.msu.ru/gis/data/Ex03.zip)

## Введение {#map-design-climates-intro}

**Цель задания** --- знакомство с моделями пространственных объектов и базой пространственных данных. Визуализация данных на карте. Оформление легенды и компоновки карты.

Параметр                    Значение
--------------------------  --------
*Теоретическая подготовка*  Не требуется
*Практическая подготовка*   Модели пространственных данных, модели пространственных объектов, базы пространственных объектов, картографические проекции
*Исходные данные*           Климатические пояса по Алисову (полигональный слой), границы морей и океанов IHO (International Hydrographic Organization), направления основных течений OSCAR (Ocean Surface Current Analyses – Real time), крупнейшие мировые реки и озера, города (данные Esri).
*Результат*                 Тематическая карта «Климат и основные объекты гидросферы» масштаба 1:90 000 000             
*Ключевые слова*            Модели пространственных данных, модели пространственных объектов, базы пространственных данных, классы пространственных объектов, визуализация пространственных данных, геоинформационное картографирование

### Контрольный лист {#map-design-climates-control}

- Добавить на карту слои базы пространственных данных и оформить их
- Настроить подписи объектов
- Создать компоновку карты, легенду и координатную сетку
- Экспортировать результат в графический файл

### Аннотация {#map-design-climates-annotation}

Задание посвящено знакомству с базами пространственных данных а также созданием тематических карт на их основе. Вы научитесь извлекать из базы данных и визуализировать пространственные данные, оформлять легенду, сетку координат и зарамочные элементы карты.

## Начало работы {#map-design-climates-begin}
[В начало упражнения ⇡](#map-design-climates)

1. Запустите приложение **ArcMap** и откройте окно **Catalog**, нажав кнопку ![](images/Ex03/image5.png) на панели инструментов

2. Найдите вашу папку в дереве каталогов в ней директорию *Ex03*.

> Если вашей директории или вышестоящей директории *D:/GIS* нет в списке, подключитесь к ней c помощью кнопки ![](images/Ex03/image6.png).

В каталоге *Ex03* находится база геоданных *MapData.gdb*, содержащая исходные данные для выполнения задания.

> **База геоданных** --- это структурированное хранилище, внутри которого можно создавать слои данных, группировать их и связывать различными отношениями.

Внутри базы геоданных могут быть объекты следующих типов:

- ![](images/Ex03/image7.png)![](images/Ex03/image8.png)![](images/Ex03/image9.png) --- слои векторных данных (классы пространственных объектов),
- ![](images/Ex03/image10.png) — слои растровых данных;
- ![](images/Ex03/image11.png) — обычные таблицы;

> **Класс пространственных объектов (feature class)** --- это набор пространственных объектов одного типа геометрии (точки, линии, полигоны или объемные тела). Для класса могут быть определены атрибуты, а его представлением является таблица, содержащая как обычные столбцы (текстовые, числовые и т.д.) так и специальное поле Shape, в котором хранится информация о геометрии. Каждая строчка в таблице — это описание одного объекта. В поле ObjectID хранится уникальный идентификатор каждого объекта.

3. Раскройте базу данных *MapData.gdb* и изучите ее содержимое, состоящее из следующих классов:

      **Класс**   **Содержание**
      ----------- --------------------
      *Cities*      Города
      *Climates*    Климатические зоны
      *Coast*       Побережье
      *Countries*   Страны
      *Currents*    Данные о течениях
      *Lakes*       Озера
      *Rivers*      Крупнейшие реки
      *Seas*        Моря

    К какому типу геометрии относятся данные классы?


1. Дважды щелкните на слое *Climates* и перейдите на вкладку XY Coordinate System.

Внимательно прочитайте информацию. Этот слой хранится в *Географической системе координат (GCS)*, отнесенной к эллипсоиду WGS-1984. Это означает, что координаты каждого объекта зафиксированы в виде широты и долготы. В любой момент этот слой можно спроецировать в любую проекцию. При этом координаты будут представлены в метрических единицах, а система координат получит название *Проецированной системы координат (PCS)*.

## Оформление базовых слоев {#map-design-climates-basic}
[В начало упражнения ⇡](#map-design-climates)

1. Ознакомьтесь с главой [__Оформление векторного слоя__](#manual-vector) в разделе описания функций.

1. Добавьте в таблицу содержания карты слой *Countries*, просто перетащив его из окна каталога.

2. Дважды щелкните на названии слоя *Countries* и перейдите на вкладку __Symbology__ (Рис. \@ref(fig:mdc-sym)).

    <div class="figure">
    <img src="images/Ex03/image12.png" alt="Возможности отображения полигонального слоя" width="20%" />
    <p class="caption">(\#fig:mdc-sym)Возможности отображения полигонального слоя</p>
    </div>

3. Внимательно изучите перечень вариантов отображения слева. Они разделены на категории **Features** (единый символ), **Categories** (качественные характеристики), **Quantities** (количественные характеристики), **Charts** (диаграммы), **Multiple Attributes** (визуализация по нескольким атрибутам).Разверните каждую группу и щелкните на каждом способе. Сопоставьте их с традиционной классификацией способов изображения.

1. Выберите способ единого символа (**Features > Single symbol**)

2. Щелкните на кнопке с изображением символа и измените оформление в диалоге настройки символа (Рис. \@ref(fig:mdc-lyrprop)) следующим образом:

    **Параметр**                      **Значение**
    --------------------------------- --------
    *Цвет заливки (Fill Color)*       Без заливки ![](images/Ex03/image13.png)
    *Цвет обводки (Outline Color)*    Серый 50% ![](images/Ex03/image14.png)
    *Толщина обводки (Outline width)* 0,5 ![](images/Ex03/image15.png)
    
    <div class="figure">
    <img src="images/Ex03/image16.png" alt="Диалог настройки символа" width="100%" />
    <p class="caption">(\#fig:mdc-lyrprop)Диалог настройки символа</p>
    </div>

    __Результат__ (Рис. \@ref(fig:mdc-lyrres)):
    
    <div class="figure">
    <img src="images/Ex03/image17.png" alt="Результат визуализации слоя стран" width="100%" />
    <p class="caption">(\#fig:mdc-lyrres)Результат визуализации слоя стран</p>
    </div>

1. Используя инструкции в разделе [__Изменение проекции__](#manual-projections-change) поменяйте проекцию карты на *проекцию Робинсона (Robinson)*. Ее можно найти в группе **Projected Сoordinate Systems > World**. Обратите внимание на то, как изменятся очертания объектов (Рис. \@ref(fig:mdc-proj)):
    
    <div class="figure">
    <img src="images/Ex03/image18.png" alt="Картографическое изображение в проекции Робинсона" width="100%" />
    <p class="caption">(\#fig:mdc-proj)Картографическое изображение в проекции Робинсона</p>
    </div>

1. Добавьте на карту слой *Coast*, расположите его поверх слоя *Countries* и измените цвет линии на *Delft Blue* (Рис. \@ref(fig:mdc-color)):
    
    <div class="figure">
    <img src="images/Ex03/image19.png" alt="Выбор цвета из палитры" width="40%" />
    <p class="caption">(\#fig:mdc-color)Выбор цвета из палитры</p>
    </div>

1. Добавьте на карту слой *Rivers* расположите его поверх слоя *Coast* и измените цвет линии на *Delft Blue,* а толщину сделайте равной 0,5 пиксела*.*

2. Добавьте на карту слой *Lakes*, расположите его поверх слоя *Rivers* и измените его оформление следующим образом:

    **Параметр**      **Значение**
    ----------------- ---------------
    *Цвет заливки*      Sodalite Blue
    *Цвет обводки*      Delft Blue
    *Толщина обводки*   0,5

    __Результат__ (Рис. \@ref(fig:mdc-hydro)):
    
    <div class="figure">
    <img src="images/Ex03/image20.png" alt="Реки и озера на картографическом изображении" width="100%" />
    <p class="caption">(\#fig:mdc-hydro)Реки и озера на картографическом изображении</p>
    </div>

1. Сохраните карту в свою директорию *Ex03*.

2. Добавьте на карту слой *Cities*, расположите его поверх слоя *Lakes* и измените его параметры следующим образом (Рис. \@ref(fig:mdc-cities)):

    **Параметр** **Значение**
    ------------ ----------
    *Символ*     Circle 1
    *Цвет*       Черный
    *Размер*     4
    
    <div class="figure">
    <img src="images/Ex03/image21.png" alt="Выбор и настройка символа для отображения населенных пунктов" width="70%" />
    <p class="caption">(\#fig:mdc-cities)Выбор и настройка символа для отображения населенных пунктов</p>
    </div>

1. Добавьте на карту слой *Seas*, расположите его внизу таблицы содержания и измените его параметры следующим образом:

    **Параметр**      **Значение**
    ----------------- -------------
    *Цвет заливки*    Нет заливки
    *Цвет обводки*    Серый 50%
    *Толщина обводки* 0,5
    *Прозрачность*    50%

    __Результат__ (Рис. \@ref(fig:mdc-seas)):
    
    <div class="figure">
    <img src="images/Ex03/image22.png" alt="Границы океанов на картографическом изображении" width="100%" />
    <p class="caption">(\#fig:mdc-seas)Границы океанов на картографическом изображении</p>
    </div>

<kbd>**Снимок экрана №1.** Базовые слои</kbd>

## Оформление данных о климате и морских течениях {#map-design-climates-thematic}

1. Добавьте на карту слой *Сlimates*, расположите его внизу таблицы содержания.

2. Откройте таблицу атрибутов слоя *Сlimates*, щелкнув на его названии правой кнопкой мыши и выбрав команду **Open Attribute Table**. Найдите в ней столбец *Type*, просмотрите его значения. Это поле таблицы хранит информацию о типе климата для каждой области. Вы будете использовать ее для классификации при отображении данного слоя.

3. Найдите поля *Shape* и *ObjectID*.

    > В поле *ObjectID* хранится уникальный идентификатор каждого объекта. Он нужен системе для того, чтобы каждый объект можно было гарантированно найти по некому однозначному критерию.

    > В поле *Shape* (вспомните, что слой полигональный) хранится список координат вершин полигона. Геометрия объектов редактируется специальными инструментами, поэтому содержимое поля Shape скрыто от пользователя.

1. Климатические пояса показываются на картах способом *качественного фона*. Для этого измените оформление слоя *Climates* следующим образом:

    **Параметр**                    **Значение**
    ------------------------------- ----------------------------------------
    *Тип визуализатора*             Categories > Unique values
    *Поле классификации*            Type
    *Сортировка значений*           От арктического к экваториальному
    *Цвета полигонов*               Традиционные цвета климатических поясов (выберите вручную)
    *Обводка полигонов*             Нет обводки
    *Показывать остальные значения* Нет

    Диалог настройки символики слоя должен выглядеть следующим образом (Рис. \@ref(fig:mdc-clim)):
    
    <div class="figure">
    <img src="images/Ex03/image23.png" alt="Настройка символов для отображения типов климата" width="100%" />
    <p class="caption">(\#fig:mdc-clim)Настройка символов для отображения типов климата</p>
    </div>

1.  Добавьте на карту слой *Сurrents*, расположите его поверх слоя *Сlimates*. Этот слой содержит данные о течениях *OSCAR (Ocean Surface Current Analyses – Real time)*, осредненные с 1993 по 2003 год.

    > Течения относятся к векторным полям. Существует множество способов визуализации векторных полей. В картографии распространен способ **градиентного поля**, при котором стрелки размещаются по регулярной сетке, их поворот соответствует направлению векторного поля в точке, а длина — скорости. Для реализации способа градиентного поля вам нужно выбрать символ (стрелку), а также указать атрибутивные поля слоя, в соответствии с которыми будет меняться их направление и длина.

1. Измените тип символа слоя на символьный маркер и задайте его параметры следующим образом (Рис. \@ref(fig:mdc-arrow)):

    **Параметр** **Значение**
    ------------ --------------
    *Шрифт*      Esri Geology
    *Символ*     Unicode 83
    *Размер*     28
    *Цвет*       Серый 70%
    
    <div class="figure">
    <img src="images/Ex03/image24.png" alt="Выбор значка для отображения направления течения" width="70%" />
    <p class="caption">(\#fig:mdc-arrow)Выбор значка для отображения направления течения</p>
    </div>

1. Нажмите *ОК* и еще раз *ОК*.

2. Чтобы задать направление стрелки, не выходя из диалога свойств слоя на вкладке **Symbology** нажмите **Advanced > Rotation…** и настройте следующие параметры вращения:

    **Параметр**    **Значение**
    --------------- ----------------
    *Поле*          Direction
    *Направление*   Арифметическое

1. Для изменения размера стрелки в зависимости от скорости течения нажмите **Advanced > Size…** Выберите в списке поле *Length* и нажмите __ОК__. Результат (Рис. \@ref(fig:mdc-currents)):
    
    <div class="figure">
    <img src="images/Ex03/image25.png" alt="Отображение течений на карте" width="100%" />
    <p class="caption">(\#fig:mdc-currents)Отображение течений на карте</p>
    </div>

__Сохраните документ карты__ через команду меню **File > Save as** в свой каталог _Ex03_ под названием *Ex03_<Фамилия>.mxd*.

> Файл с расширением `.mxd` является файлом документа карты __ArcMap__. Он содержит перечень слоев и их настроек, созданные компоновки и ряд дополнительных параметров. Документ карты, как и входящие в него слои, не хранит сами данные, а лишь _ссылается_ на них. Поэтому, перемещая проект на другой компьютер, вы должны также переместить и данные, чтобы он открылся (в вашем случае — базу геоданных, из которой вы добавляли классы объектов на карту).

<kbd>**Снимок экрана №2.** Климат и направления морских течений</kbd>

## Настройка подписей {#map-design-climates-labels}
[В начало упражнения ⇡](#map-design-climates)

1. Включите механизм размещения подписей __Maplex__ на панели __Labeling__ (Рис. \@ref(fig:mdc-maplex)):
    
    <div class="figure">
    <img src="images/Ex03/image26.png" alt="Включение механизма размещения подписей Maplex" width="40%" />
    <p class="caption">(\#fig:mdc-maplex)Включение механизма размещения подписей Maplex</p>
    </div>

1. Дважды щелкните на слое *Cities*, и перейдите на вкладку *Labels*.

2. Включите подписи для слоя *Cities* (Рис. \@ref(fig:mdc-labels)):
    
    <div class="figure">
    <img src="images/Ex03/image27.png" alt="Включение подписей" width="30%" />
    <p class="caption">(\#fig:mdc-labels)Включение подписей</p>
    </div>

1. Настройте параметры подписей следующим образом (Рис. \@ref(fig:mdc-labparams)):

    **Параметр**            **Значение**
    ----------------------- -----------------------------------
    *Label Field*           Название
    *Размер*                7
    *Цвет*                  Черный
    *Разрешение конфликтов* Never remove (никогда не удалять)
    
    <div class="figure">
    <img src="images/Ex03/image28.png" alt="Параметры настройки подписей населенных пунктов" width="80%" />
    <p class="caption">(\#fig:mdc-labparams)Параметры настройки подписей населенных пунктов</p>
    </div>

1. Включите подписи для слоя *Rivers* со следующими параметрами:

    **Параметр**        **Значение**
    ------------------- -----------------------------
    *Label Field*       Title
    *Размер*            8
    *Цвет*              Delft Blue
    *Начертание*        Курсивное
    *Размещение*        Curved (криволинейно вдоль)
    *Удалять дубликаты* Да

1. Включите подписи для слоя *Seas* со следующими параметрами:

    **Параметр** **Значение**
    ------------ ------------
    *Поле*       Name
    *Размер*     7
    *Цвет*       Delft Blue

1. Переименуйте все слои на русский язык следующим образом:

    **Исходное название**  **Результирующее название**
    ---------------------- -------------------------
    *Cities*               Города
    *Climates*             Климат
    *Coast*                Побережье
    *Countries*            Страны
    *Currents*             Течения
    *Lakes*                Озера
    *Rivers*               Реки
    
    Результат (Рис. \@ref(fig:mdc-labelres)):
    
    <div class="figure">
    <img src="images/Ex03/image29.png" alt="Отображение подписей на карте" width="100%" />
    <p class="caption">(\#fig:mdc-labelres)Отображение подписей на карте</p>
    </div>

1. Сохраните карту.

<kbd>**Снимок экрана №3.** Подписи объектов</kbd>

## Настройка компоновки {#map-design-climates-layout}
[В начало упражнения ⇡](#map-design-climates)

1. Переключитесь в вид компоновки с помощью команды меню *View — Layout View*.

2. Настройте макет страницы следующим образом:

    - Размер А3
    - Альбомная ориентировка

3. Подгоните размер фрейма данных таким образом, чтобы карта заняла площадь всего листа с небольшим запасом.

4. Установите масштаб равным `1:90 000 000` и отцентрируйте карту в пределах листа.

    Результат (Рис. \@ref(fig:mdc-scale)):
    
    <div class="figure">
    <img src="images/Ex03/image30.png" alt="Итоговый охват карты" width="100%" />
    <p class="caption">(\#fig:mdc-scale)Итоговый охват карты</p>
    </div>

1. Добавьте на карту легенду с помощью команды **Insert > Legend**, включив в нее только слои *Климат* и *Течения* (Рис. \@ref(fig:mdc-legendial)):
    
    <div class="figure">
    <img src="images/Ex03/image31.png" alt="Добавление слоев _Климат_ и _Течения_ в состав легенды" width="80%" />
    <p class="caption">(\#fig:mdc-legendial)Добавление слоев _Климат_ и _Течения_ в состав легенды</p>
    </div>

1. В следующем диалоге название легенды оставьте пустым (Рис. \@ref(fig:mdc-legendempty)):
    
    <div class="figure">
    <img src="images/Ex03/image32.png" alt="Пустой заголовок легенды" width="80%" />
    <p class="caption">(\#fig:mdc-legendempty)Пустой заголовок легенды</p>
    </div>

1. Далее все параметры оставьте по умолчанию.

2. Уберите заголовок поля для слоя *Климат*, выделив его мышью, нажав <kbd>F2</kbd> и стерев содержимое (Рис. \@ref(fig:mdc-fieldempty)):
    
    <img src="images/Ex03/image33.png" width="20%" />
    <div class="figure">
    <img src="images/Ex03/image34.png" alt="Удаление заголовка поля для слоя _Климат_" width="20%" />
    <p class="caption">(\#fig:mdc-fieldempty)Удаление заголовка поля для слоя _Климат_</p>
    </div>

1.  Добавьте градусную сетку координат со следующими параметрами:

    **Параметр** **Значение**
    ------------ ----
    *Шаг по X*   20
    *Шаг по Y*   20

1. Измените начало расстановки линий сетки для оси *Y* на 0.

2. Отключите [__отображение нулевых минут и секунд__](#manual-projections-zero-degrees).

3. Разместите над картой текст «КЛИМАТ И ОСНОВНЫЕ ОБЪЕКТЫ ГИДРОСФЕРЫ».

4. Разместите под картой по центру численный масштаб `1:90 000 000`.

5. Разместите в правом нижнем углу карты текст «Выполнил» и свое ФИО.

    Результат (Рис. \@ref(fig:mdc-finalres)):
    
    <div class="figure">
    <img src="images/Ex03/image35.png" alt="Итоговая карта" width="100%" />
    <p class="caption">(\#fig:mdc-finalres)Итоговая карта</p>
    </div>

1. Сохраните карту.

<kbd>**Снимок экрана №4.** Итоговая карта</kbd>

## Экспорт в графический файл {#map-design-climates-export}
[В начало упражнения ⇡](#map-design-climates)

1. Экспортируйте карту из режима компоновки в формат `PNG` с разрешением 300 точек на дюйм с помощью команды **File > Export Map**. Сохраните его в свою директорию.

2. Вставьте карту в отчетный файл.

## Контрольные вопросы {#map-design-climates-questions}
[В начало упражнения ⇡](#map-design-climates)

1. Какие типы геометрии допустимы для слоев в базе геоданных? К каким типам относятся слои, использованные вами в работе?

2. В какой системе координат хранились данные, которые вы использовали для составления карты?  

3. Какая проекция была использована вами в работе? К какому типу по характеру искажений она относится?  

4. Где хранятся данные, которые используются для классификации символов при отображении, изменения их размера и направления?

5. За что отвечают системные поля _Shape_ и _ObjectID_?

6. Чем отличается вид компоновки от вида данных? Для чего требуется каждый из них?

----
_Самсонов Т.Е._ **Основы геоинформатики: практикум**. М.: Географический факультет МГУ, 2020. DOI: 10.5281/zenodo.1167857
----
