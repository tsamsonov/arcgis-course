# Создание социально-экономической карты {#map-design-economic}



[Скачать данные и файл отчета](http://autolab.geogr.msu.ru/gis/data/Ex04.zip)

## Введение {#map-design-economic-intro}

**Цель задания** --- знакомство с моделями пространственных объектов и базой пространственных данных. Визуализация данных на карте. Оформление легенды и компоновки карты.

Параметр                    Значение
--------------------------  --------
*Теоретическая подготовка*  Модели пространственных данных, модели пространственных объектов, базы пространственных объектов, картографические проекции
*Практическая подготовка*   Не требуется
*Исходные данные*           Сетка субъектов Федерации с привязанной статистикой по населению, государственная граница России, крупнейшие города России, крупнейшие озера, страны.
*Результат*                 Тематическая карта «Население России» масштаба 1:35 000 000
*Ключевые слова*            Модели пространственных данных, модели пространственных объектов, базы пространственных данных, классы пространственных объектов, визуализация пространственных данных, геоинформационное картографирование

### Контрольный лист {#map-design-economic-control}

* Добавить на карту слои базы пространственных данных и оформить их
* Настроить подписи объектов
* Создать компоновку карты, легенду и координатную сетку
* Экспортировать результат в графический файл

### Аннотация {#map-design-economic-annotation}

Задание посвящено знакомству с ГИС на примере создания социально-экономической карты. Вы познакомитесь с представлением площадных, линейных, точечных объектов в базе пространственных данных. Научитесь создавать карты на их основе, оформлять легенду, добавлять сетку координат и зарамочные элементы карты, познакомитесь с применением картограмм и картодиаграмм в геоинформационном картографировании.

## Начало работы {#map-design-economic-begin}
[В начало упражнения ⇡](#map-design-economic)

1. Скачайте с сервера каталог *Ex04* и положите его в свою директорию.

1. Запустите приложение **ArcMap** и откройте окно **Сatalog**, нажав кнопку ![](images/Ex01/image2.png) на панели инструментов.

2. Подключитесь к рабочему каталогу *Ex04* в окне **Сatalog** (Рис. \@ref(fig:mde-cat)):
    
    <div class="figure">
    <img src="images/Ex04/image2.png" alt="Окно Catalog" width="40%" />
    <p class="caption">(\#fig:mde-cat)Окно Catalog</p>
    </div>

    В каталоге *Ex04* находится база геоданных *MapData.gdb*, содержащая исходные данные для выполнения задания.

    > **База геоданных** — это структурированное хранилище, внутри которого можно создавать слои данных, группировать их и связывать различными отношениями.

    Внутри базы геоданных могут быть объекты следующих типов:

    - ![](images/Ex04/image3.png)![](images/Ex04/image4.png)![](images/Ex04/image5.png) --- слои векторных данных (классы пространственных объектов),
    - ![](images/Ex04/image6.png) — слои растровых данных;
    - ![](images/Ex04/image7.png) — обычные таблицы;

    > **Класс пространственных объектов (feature class)** --- это набор пространственных объектов одного типа геометрии (точки, линии, полигоны). Для класса могут быть определены атрибуты, а его представлением является таблица, содержащая столбцы разного типа (текстовые, числовые и т.д.). Каждая строчка в таблице — это описание одного объекта.

1. Раскройте базу данных *MapData.gdb* и изучите классы пространственных объектов внутри нее:

    **Класс**    **Содержание**
    ------------ ----------------------------
    *Borders*    Государственная граница РФ
    *Cities*     Города
    *Lakes*      Озера
    *Regions*    Субъекты федерации
    *Countries*  Страны

    К какому типу геометрии относятся данные классы?

1. Дважды щелкните на слое *Regions* и перейдите на вкладку **XY Coordinate System**.

    Внимательно прочитайте информацию. Этот слой хранится в *Географической системе координат (GCS)*, отнесенной к эллипсоиду WGS-1984. Это означает, что координаты каждого объекта хранятся в виде широты и долготы. Этот слой можно спроецировать в любую проекцию. При этом координаты будут представлены в метрических единицах, а система координат получит название *Проецированной системы координат (PCS)*.

## Создание картограмм {#map-design-economic-choropleth}
[В начало упражнения ⇡](#map-design-economic)

1. Добавьте на карту слой *Regions*. Для этого просто перетащите его из окна Каталога на карту.

2. Переименуйте его в «*Плотность населения*». Для этого дважды (медленно) щелкните на названии слоя или выделите его и нажмите клавишу <kbd>F2</kbd> (Рис. \@ref(fig:mde-ren)):
    
    <div class="figure">
    <img src="images/Ex04/image8.png" alt="Переименование слоя" width="35%" />
    <p class="caption">(\#fig:mde-ren)Переименование слоя</p>
    </div>

1. Используя инструкции в разделе [Изменение проекции](#manual-projections-change), измените проекцию карты на равновеликую коническую проекцию Альберса. Ее можно найти по следующему пути:

    **Projected Coordinate Systems > Continental > Asia > Asia North Albers Equal Area Conic**

    Обратите внимание на то, как изменится форма отображаемых объектов.

1. Откройте таблицу атрибутов слоя. Найдите в ней столбец *Density*, просмотрите его значения. Это поле таблицы хранит значения плотности населения по субъектам.

2. Найдите поля *Shape* и *ObjectID*.

    > В поле *ObjectID* хранится уникальный идентификатор каждого объекта. Он нужен системе для того, чтобы каждый объект можно было гарантированно найти по некому однозначному критерию.

    > В поле *Shape* хранится геометрия объектов. Если слой точечный — это будут просто пары координат X и Y для каждого объекта. Для линейных и полигональных слоев это будет уже упорядоченный набор пар координат вершин границы объекта. Геометрия редактируется специальными инструментами, поэтому содержимое поля *Shape* скрыто от пользователя.

1. Дважды щелкните на названии слоя и на вкладке **Symbology** и выберите способ изображения *Quantity — Graduated colors* (Градуированные цвета).

2. Выберите в списке **Value Field** поле *Density*, система автоматически сформирует список классов, созданных методом естественных интервалов.

    > Существует множество методов классификаций: равных интервалов, квантилей, стандартных отклонений и т.д. По умолчанию всегда выбирается метод естественных интервалов, т.к. считается, что он в среднем неплохо отражает особенности распределения. Следует знать, однако, что этот метод классификации плохо справляется с распределениями, обладающими значительной асимметрией и эксцессом (*heavy-tail distribution*).

1. Измените число классов на 7 (Рис. \@ref(fig:mde-cla)):
    
    <div class="figure">
    <img src="images/Ex04/image9.png" alt="Изменение числа классов в методе Естественных интервалов" width="30%" />
    <p class="caption">(\#fig:mde-cla)Изменение числа классов в методе Естественных интервалов</p>
    </div>

1. Измените метод классификации. Для этого нажмите **Classify**. В появившемся диалоговом окне выберите в списке сверху ручной метод задания интервалов (*Manual*) и в правом столбце замените первые шесть значений на следующие: 1, 10, 25, 50, 100, 250. Максимальное значение оставьте без изменений. Жмите **ОК** (Рис. \@ref(fig:mde-cle)):
    
    <div class="figure">
    <img src="images/Ex04/image10.png" alt="Ручное редактирование границ классов" width="80%" />
    <p class="caption">(\#fig:mde-cle)Ручное редактирование границ классов</p>
    </div>

1. На вкладке **Symbology** выберите цветовую шкалу *Yellow To Dark Red* (Рис. \@ref(fig:mde-ramp)):
    
    <div class="figure">
    <img src="images/Ex04/image11.png" alt="Цветовая шкала от желтого к темно-красному" width="40%" />
    <p class="caption">(\#fig:mde-ramp)Цветовая шкала от желтого к темно-красному</p>
    </div>

1. Инвертируйте сортировку классов, чтобы наверху оказались максимальные градации (Рис. \@ref(fig:mde-clssort)):
    
    <div class="figure">
    <img src="images/Ex04/image12.png" alt="Инвертирование сортировки классов" width="45%" />
    <p class="caption">(\#fig:mde-clssort)Инвертирование сортировки классов</p>
    </div>

1. Инвертируйте цветовую шкалу, чтобы цвета соответствовали градациям (Рис. \@ref(fig:mde-colsort)):

    <div class="figure">
    <img src="images/Ex04/image13.png" alt="Инвертирование цветового градиента" width="35%" />
    <p class="caption">(\#fig:mde-colsort)Инвертирование цветового градиента</p>
    </div>

1. В основном диалоге настройки символов исправьте подписи классов (столбец *Label*) в соответствии с нижеприведенным фрагментом (Рис. \@ref(fig:mde-labedit)):
    
    <div class="figure">
    <img src="images/Ex04/image14.png" alt="Редактирование подписей классов" width="80%" />
    <p class="caption">(\#fig:mde-labedit)Редактирование подписей классов</p>
    </div>

1. Нажмите **ОК**.

2. Переименуйте показатель в «*чел/кв. км*» (Рис. \@ref(fig:mde-unedit)):
    
    <div class="figure">
    <img src="images/Ex04/image15.png" alt="Редактирование единиц измерения" width="30%" />
    <p class="caption">(\#fig:mde-unedit)Редактирование единиц измерения</p>
    </div>

    *Результат* (Рис. \@ref(fig:mde-choropleth)):
    
    <div class="figure">
    <img src="images/Ex04/image16.png" alt="Визуализация плотности населения по регионам" width="100%" />
    <p class="caption">(\#fig:mde-choropleth)Визуализация плотности населения по регионам</p>
    </div>

<kbd>**Снимок экрана №1.** Картограммы плотности населения</kbd>

__Сохраните документ карты__ через команду меню **File > Save as** в свой каталог _Ex04_ под названием *Ex04_<Фамилия>.mxd*.

> Файл с расширением `.mxd` является файлом документа карты __ArcMap__. Он содержит перечень слоев и их настроек, созданные компоновки и ряд дополнительных параметров. Документ карты, как и входящие в него слои, не хранит сами данные, а лишь _ссылается_ на них. Поэтому, перемещая проект на другой компьютер, вы должны также переместить и данные, чтобы он открылся (в вашем случае — базу геоданных, из которой вы добавляли классы объектов на карту).

## Создание картодиаграмм {#map-design-economic-diagrams}
[В начало упражнения ⇡](#map-design-economic)

1. Скопируйте и вставьте слой «*Плотность населения*». Переименуйте его в «*Численность населения*» (Рис. \@ref(fig:mde-popedit)):
    
    <div class="figure">
    <img src="images/Ex04/image17.png" alt="Редактирование названия слоя численности населения" width="35%" />
    <p class="caption">(\#fig:mde-popedit)Редактирование названия слоя численности населения</p>
    </div>

1. Разместите новый слой поверх слоя плотности населения.

2. Измените его способ изображения на *Картодиаграммы (Quantities > Graduated Symbols)* (Градуированные символы).

3. Выберите для отображения поле *SUM\_Все\_население*. Появится шкала классификации показателя.

4. Измените цвет кружка на голубой. Для этого нажмите кнопку **Template**, выберите значок *Circle 2* с тонкой обводкой и смените цвет заливки (Рис. \@ref(fig:mde-popsym)):
    
    <div class="figure">
    <img src="images/Ex04/image18.png" alt="Выбор символа для построения диаграмм" width="100%" />
    <p class="caption">(\#fig:mde-popsym)Выбор символа для построения диаграмм</p>
    </div>

1. Установите число классов равным `6` (Рис. \@ref(fig:mde-popncla)):

    <div class="figure">
    <img src="images/Ex04/image19.png" alt="Редактирование количества классов для диаграмм" width="80%" />
    <p class="caption">(\#fig:mde-popncla)Редактирование количества классов для диаграмм</p>
    </div>

1. Аналогично предыдущему слою выберите ручной метод классификации и введите следующие границы классов: $500, 1000, 2500, 5000, 10000$. Максимальную границу оставьте прежней (Рис. \@ref(fig:mde-popbrcla)):

    <div class="figure">
    <img src="images/Ex04/image20.png" alt="Редактирование границ классов для диаграмм" width="80%" />
    <p class="caption">(\#fig:mde-popbrcla)Редактирование границ классов для диаграмм</p>
    </div>

1. Нажмите **ОК**.

2. Инвертируйте порядок классов и порядок символов в классификации (аналогично предыдущему слою) так чтобы наверху оказались максимальные значения.

3. Установите на вкладке **Symbology** максимальный и минимальный размер значка равным 18 и 4 пункта соответственно (Рис. \@ref(fig:mde-popsize)):

    <div class="figure">
    <img src="images/Ex04/image21.png" alt="Изменение границ размеров символа" width="40%" />
    <p class="caption">(\#fig:mde-popsize)Изменение границ размеров символа</p>
    </div>

1. Отредактируйте подписи классов по аналогии с картограммами (Рис. \@ref(fig:mde-poplabcla)):

    <div class="figure">
    <img src="images/Ex04/image22.png" alt="Редактирование подписей классов размеров кружков" width="50%" />
    <p class="caption">(\#fig:mde-poplabcla)Редактирование подписей классов размеров кружков</p>
    </div>

1. Задайте символ фона картодиаграмм в виде полигона с пустой заливкой и пустой обводкой. Для этого щелкните на кнопке **Background** и выберите режим *No Color* для заливки и для обводки (Рис. \@ref(fig:mde-popnocolor)):

    <div class="figure">
    <img src="images/Ex04/image23.png" alt="Установка пустого цвета заливки и обводки полигонов" width="100%" />
    <p class="caption">(\#fig:mde-popnocolor)Установка пустого цвета заливки и обводки полигонов</p>
    </div>

1. Нажмите **ОК**.

    *Результат* (Рис. \@ref(fig:mde-popdiag)):
    
    <div class="figure">
    <img src="images/Ex04/image24.png" alt="Картодиаграммы численности населения" width="100%" />
    <p class="caption">(\#fig:mde-popdiag)Картодиаграммы численности населения</p>
    </div>

    <kbd>**Снимок экрана №2.** Картодиаграммы численности населения</kbd>

1. Сохраните документ карты

## Оформление географической основы {#map-design-economic-general}
[В начало упражнения ⇡](#map-design-economic)

1. Добавьте на карту слои *Borders*, *Cities*, *Countries* и *Lakes*. Установите следующий порядок слоев в таблице содержания:

    a. *Cities*
    b. *Borders*
    c. *Lakes*
    d. *Численность населения*
    e. *Плотность населения*
    f. *Countries*

2. Переименуйте вновь добавленные слои следующим образом:

    **Исходное название**   **Результирующее название**
    ----------------------- -------------------------
    *Cities*                Города
    *Borders*               Граница РФ
    *Lakes*                 Озера
    *Countries*             Страны

1. Присвойте слою *Граница РФ* единый символ *Boundary, National.*

2. Присвойте слою *Озера* единый символ *Lake.*

3. Измените цвет точек слоя *Города* на белый.

4. Установите следующие параметры оформления для площадного слоя *Страны*:

    **Параметр**      **Значение**
    ----------------- -----------
    *Цвет заливки*    Серый 10%
    *Цвет обводки*    Серый 50%
    *Толщина обводки* 1

    *Результат* (Рис. \@ref(fig:mde-popback)):
    
    <div class="figure">
    <img src="images/Ex04/image25.png" alt="Карта с элементами общегеографической основы" width="100%" />
    <p class="caption">(\#fig:mde-popback)Карта с элементами общегеографической основы</p>
    </div>

    <kbd>**Снимок экрана №3.** Карта с элементами общегеографической основы</kbd>

1. Сохраните документ карты.

## Настройка подписей {#map-design-economic-labels}
[В начало упражнения ⇡](#map-design-economic)

1. Включите механизм размещения подписей **Maplex** (Рис. \@ref(fig:mde-maplex)):
    
    <div class="figure">
    <img src="images/Ex04/image26.png" alt="Механизм размещения подписей Maplex" width="40%" />
    <p class="caption">(\#fig:mde-maplex)Механизм размещения подписей Maplex</p>
    </div>

1. Включите подписи для слоя *Города* на вкладке **Labels**. Выберите в качестве поля для подписей *name\_2.* Остальные настройки оставьте по умолчанию (Рис. \@ref(fig:mde-labels)):
    
    <div class="figure">
    <img src="images/Ex04/image27.png" alt="Диалог настройки подписей слоя Города" width="100%" />
    <p class="caption">(\#fig:mde-labels)Диалог настройки подписей слоя Города</p>
    </div>

1. Включите подписи для слоя _Страны_. Настройте подписи следующим образом:

    **Параметр**                          **Значение**
    ------------------------------------- ------------------------
    *Поле (label field)*                  Название
    *Тип размещения*                      Криволинейное (Curved)
    *Разрядка слов*                       Да
    *Разрядка букв*                       Да
    *Подписывать только наибольшую часть* Да

    *Результат* (Рис. \@ref(fig:mde-wlabels)): 
    
    <div class="figure">
    <img src="images/Ex04/image28.png" alt="Карта с подписями объектов" width="100%" />
    <p class="caption">(\#fig:mde-wlabels)Карта с подписями объектов</p>
    </div>

    <kbd>**Снимок экрана №4.** Карта с подписями объектов</kbd>

1. Сохраните документ карты.

## Настройка компоновки {#map-design-economic-layout}
[В начало упражнения ⇡](#map-design-economic)

1. Переключитесь в вид компоновки через команду меню **View > Layout View**

2. Настройте макет страницы следующим образом:

    - Размер А4
    - Альбомная ориентировка

3. Установите масштаб карты равным $1:35 000 000$. Подгоните размер фрейма данных таким образом, чтобы он был слегка больше контура России. Для этого используйте стрелку ![](images/Ex04/image29.png) на панели **Tools**. Разместите его в правом верхнем углу карты.

4. Отцентрируйте контур России внутри фрейма (рамки). Для этого используйте лапу ![](images/Ex04/image30.png) на панели **Tools**.

5. Смените цвет фрейма данных (фона) на светло-голубой.

    *Результат* (Рис. \@ref(fig:mde-frcolor)):
    
    <div class="figure">
    <img src="images/Ex04/image31.png" alt="Картографическое изображение со светло-голубым фоновым цветом" width="100%" />
    <p class="caption">(\#fig:mde-frcolor)Картографическое изображение со светло-голубым фоновым цветом</p>
    </div>

1. Добавьте на карту легенду, включив в нее только слои *Численность населения* и *Плотность населения.* Нажмите **Далее** (Рис. \@ref(fig:mde-leglyrs)).

    <div class="figure">
    <img src="images/Ex04/image32.png" alt="Добавление слоев в легенду карты" width="80%" />
    <p class="caption">(\#fig:mde-leglyrs)Добавление слоев в легенду карты</p>
    </div>

1. В следующем диалоге название легенды оставьте пустым (Рис. \@ref(fig:mde-legtitle)):

    <div class="figure">
    <img src="images/Ex04/image33.png" alt="Пустое название легенды" width="80%" />
    <p class="caption">(\#fig:mde-legtitle)Пустое название легенды</p>
    </div>

1. Далее все параметры оставьте по умолчанию.

2. Добавьте сетку координат со следующими параметрами:

    **Параметр**      **Значение**
    ----------------- -----------
    *Тип сетки*       градусная
    *Шаг по широте*   10
    *Шаг по долготе*  10

1. Отключите [отображение нулевых минут и секунд](#manual-projections-zero-degrees).

2. Разместите над картой текст заголовка карты, используя панель **Drawing** или меню **Insert** (Рис. \@ref(fig:mde-text)):
    
    <div class="figure">
    <img src="images/Ex04/image34.png" alt="Добвление текста через панель __Drawing__" width="80%" />
    <p class="caption">(\#fig:mde-text)Добвление текста через панель __Drawing__</p>
    </div>

1. Разместите под картой по центру численный масштаб $1:30 000 000$.

2. Разместите в правом нижнем углу карты текст «Выполнил» и свое ФИО.

    **Результат** (Рис. \@ref(fig:mde-res)):
    
    <div class="figure">
    <img src="images/Ex04/image35.png" alt="Итоговый вид карты" width="100%" />
    <p class="caption">(\#fig:mde-res)Итоговый вид карты</p>
    </div>

    <kbd>**Снимок экрана №5.** Итоговая карта</kbd>

1. Сохраните документ карты.

## Экспорт в графический файл {#map-design-economic-export}
[В начало упражнения ⇡](#map-design-economic)

1. Экспортируйте карту из режима компоновки (**File > Export Map...**) в формат *PNG* с разрешением *300* точек на дюйм. Сохраните его в свою директорию.

2. Вставьте карту в отчетный файл

## Контрольные вопросы {#map-design-economic-questions}
[В начало упражнения ⇡](#map-design-economic)

1.	Какие типы геометрии допустимы для слоев в базе геоданных? К каким типа относятся слои, использованные вами в работе?

2.	В какой системе координат хранились данные, которые вы использовали для составления карты?  

3.	Какая проекция была использована вами в работе? К какому типу по характеру искажений она относится?  

4.	Где хранятся числовые данные, которые используются для построения картограмм и картодиаграмм?

5.	За что отвечают системные поля *Shape* и *ObjectID*?

6.	Чем отличается вид компоновки от вида данных?
